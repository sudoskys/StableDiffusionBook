
<!DOCTYPE html>

<html class="no-js" lang="zh">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="一个介绍 Ai 绘画的 WIKI/A WIKI about Ai painting" name="description"/>
<meta content="StableDiffusionBook Team" name="author"/>
<link href="https://stable-diffusion-book.vercel.app/zh/train/DreamBooth/" rel="canonical"/>
<link href="../../../assets/images/favicon.png" rel="icon"/>
<meta content="mkdocs-1.4.2, mkdocs-material-8.5.10" name="generator"/>
<title>DreamBooth 训练 - AiDraw</title>
<link href="../../../assets/stylesheets/main.472b142f.min.css" rel="stylesheet"/>
<link href="../../../assets/stylesheets/palette.08040f6c.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
<meta content="website" property="og:type"/>
<meta content="DreamBooth 训练 - AiDraw" property="og:title"/>
<meta content="一个介绍 Ai 绘画的 WIKI/A WIKI about Ai painting" property="og:description"/>
<meta content="https://stable-diffusion-book.vercel.app/assets/images/social/train/DreamBooth.png" property="og:image"/>
<meta content="image/png" property="og:image:type"/>
<meta content="1200" property="og:image:width"/>
<meta content="630" property="og:image:height"/>
<meta content="https://stable-diffusion-book.vercel.app/zh/train/DreamBooth/" property="og:url"/>
<meta content="summary_large_image" name="twitter:card"/>
<meta content="DreamBooth 训练 - AiDraw" name="twitter:title"/>
<meta content="一个介绍 Ai 绘画的 WIKI/A WIKI about Ai painting" name="twitter:description"/>
<meta content="https://stable-diffusion-book.vercel.app/assets/images/social/train/DreamBooth.png" name="twitter:image"/>
<link href="../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            
                .gscrollbar-fixer { padding-right: 15px; }
                .gdesc-inner { font-size: 0.75rem; }
                body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
                body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
                body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}
                </style><script src="../../../assets/javascripts/glightbox.min.js"></script></head>
<body data-md-color-accent="" data-md-color-primary="white" data-md-color-scheme="default" dir="ltr">
<script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#dreambooth">
          跳转至
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="页眉" class="md-header__inner md-grid">
<a aria-label="AiDraw" class="md-header__button md-logo" data-md-component="logo" href="../../" title="AiDraw">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m20.71 4.63-1.34-1.34c-.37-.39-1.02-.39-1.41 0L9 12.25 11.75 15l8.96-8.96c.39-.39.39-1.04 0-1.41M7 14a3 3 0 0 0-3 3c0 1.31-1.16 2-2 2 .92 1.22 2.5 2 4 2a4 4 0 0 0 4-4 3 3 0 0 0-3-3Z"></path></svg>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            AiDraw
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              DreamBooth 训练
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="" data-md-color-media="" data-md-color-primary="white" data-md-color-scheme="default" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_2" hidden="" title="Switch to dark mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"></path></svg>
</label>
<input aria-label="Switch to light mode" class="md-option" data-md-color-accent="" data-md-color-media="" data-md-color-primary="black" data-md-color-scheme="slate" id="__palette_2" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to light mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"></path></svg>
</label>
</form>
<div class="md-header__option">
<div class="md-select">
<button aria-label="选择当前语言" class="md-header__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m12.87 15.07-2.54-2.51.03-.03A17.52 17.52 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04M18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12m-2.62 7 1.62-4.33L19.12 17h-3.24Z"></path></svg>
</button>
<div class="md-select__inner">
<ul class="md-select__list">
<li class="md-select__item">
<a class="md-select__link" href="../../../train/DreamBooth/" hreflang="zh">
                    简体中文
                  </a>
</li>
<li class="md-select__item">
<a class="md-select__link" href="../../../en/train/DreamBooth/" hreflang="en">
                    English
                  </a>
</li>
</ul>
</div>
</div>
</div>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="搜索" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="搜索" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
</label>
<nav aria-label="查找" class="md-search__options">
<button aria-label="清空当前内容" class="md-search__icon md-icon" tabindex="-1" title="清空当前内容" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/sudoskys/StableDiffusionBook" title="前往仓库">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg>
</div>
<div class="md-source__repository">
    GitHub
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<nav aria-label="标签" class="md-tabs" data-md-component="tabs">
<div class="md-tabs__inner md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../">
        起步于此
      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../Perpare/">
        开始之前
      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../install/">
        安装配置
      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../model/">
        绘画调试
      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../paint/">
        绘画指南
      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link md-tabs__link--active" href="../">
        训练模型
      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../landing/">
        参考资料
      </a>
</li>
</ul>
</div>
</nav>
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="导航栏" class="md-nav md-nav--primary md-nav--lifted" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="AiDraw" class="md-nav__button md-logo" data-md-component="logo" href="../../" title="AiDraw">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m20.71 4.63-1.34-1.34c-.37-.39-1.02-.39-1.41 0L9 12.25 11.75 15l8.96-8.96c.39-.39.39-1.04 0-1.41M7 14a3 3 0 0 0-3 3c0 1.31-1.16 2-2 2 .92 1.22 2.5 2 4 2a4 4 0 0 0 4-4 3 3 0 0 0-3-3Z"></path></svg>
</a>
    AiDraw
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/sudoskys/StableDiffusionBook" title="前往仓库">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg>
</div>
<div class="md-source__repository">
    GitHub
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_1" id="__nav_1" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../../">起步于此</a>
<label for="__nav_1">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-label="起步于此" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_1">
<span class="md-nav__icon md-icon"></span>
          起步于此
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../GettingStarted/news/">
        新闻
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../GettingStarted/term/">
        术语
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../GettingStarted/state/">
        声明
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../GettingStarted/contributing/">
        贡献指南
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_2" id="__nav_2" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../../Perpare/">开始之前</a>
</div>
<nav aria-label="开始之前" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
          开始之前
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_3" id="__nav_3" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../../install/">安装配置</a>
<label for="__nav_3">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-label="安装配置" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
          安装配置
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_3_2" id="__nav_3_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_2">
          WebUi安装
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="WebUi安装" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_2">
<span class="md-nav__icon md-icon"></span>
          WebUi安装
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../install/WebUi/set/">
        基本指南
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../install/WebUi/launch/">
        运行WebUi
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../install/WebUi/Troubleshoot/">
        错误处理
      </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_4" id="__nav_4" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../../model/">绘画调试</a>
<label for="__nav_4">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-label="绘画调试" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
          绘画调试
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../model/GPU/">
        GPU相关
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../model/NAI/">
        NAI泄漏报告
      </a>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_4_4" id="__nav_4_4" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../../model/WebUi/">WebUi 配置</a>
<label for="__nav_4_4">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-label="WebUi 配置" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_4_4">
<span class="md-nav__icon md-icon"></span>
          WebUi 配置
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../model/WebUi/base/">
        基本指南
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../model/WebUi/Troubleshoot/">
        错误处理
      </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_5" id="__nav_5" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../../paint/">绘画指南</a>
<label for="__nav_5">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-label="绘画指南" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_5">
<span class="md-nav__icon md-icon"></span>
          绘画指南
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_5_2" id="__nav_5_2" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../../paint/WebUi/">WebUi绘画指南</a>
<label for="__nav_5_2">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-label="WebUi绘画指南" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_2">
<span class="md-nav__icon md-icon"></span>
          WebUi绘画指南
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../paint/WebUi/base/">
        基本指南
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../paint/WebUi/Advanced/">
        进阶指南
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../paint/WebUi/extension/">
        安装扩展
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_5_3" id="__nav_5_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_5_3">
          实战指南
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="实战指南" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_3">
<span class="md-nav__icon md-icon"></span>
          实战指南
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../paint/Practicalguide/">
        实战指南
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../paint/identify/">
        鉴别
      </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" id="__nav_6" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../">训练模型</a>
<label for="__nav_6">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-label="训练模型" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_6">
<span class="md-nav__icon md-icon"></span>
          训练模型
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../Textual/">
        Textual 训练
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Hypernetwork/">
        Hypernetwork 训练
      </a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" data-md-toggle="toc" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
          DreamBooth 训练
          <span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
        DreamBooth 训练
      </a>
<nav aria-label="目录" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      目录
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#_1">
    简介
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_2">
    选择
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_3">
    准备
  </a>
<nav aria-label="准备" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#_4">
    模型转换
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_5">
    数据集
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_6">
    标注图片
  </a>
<nav aria-label="标注图片" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#augmentation">
    Augmentation
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_7">
    参数
  </a>
<nav aria-label="参数" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#_8">
    参数设置
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_9">
    脚本重点参数
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_10">
    关键说明
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#instance-prompt-class-prompt">
    解释 Instance Prompt / Class Prompt
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#v">
    关于这个 [V]
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#subject-images-class-images">
    解释 Subject images / Class images
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#native-training">
    Native Training
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_11">
    从检查点恢复训练
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#train-text-encoder">
    Train Text Encoder
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#multiple-concept">
    Multiple Concept
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#aspect-ratio-bucketing">
    Aspect Ratio Bucketing
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_12">
    训练
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#windows">
    在 Windows 上使用
  </a>
<nav aria-label="在 Windows 上使用" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#_13">
    临时指南
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_14">
    其他 ...
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#dreambooth_1">
    DreamBooth 参数表
  </a>
<nav aria-label="DreamBooth 参数表" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#arguments">
    Arguments
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../AestheticGradients/">
        AestheticGradients 训练
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_7" id="__nav_7" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../../landing/">参考资料</a>
</div>
<nav aria-label="参考资料" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_7">
<span class="md-nav__icon md-icon"></span>
          参考资料
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="目录" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      目录
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#_1">
    简介
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_2">
    选择
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_3">
    准备
  </a>
<nav aria-label="准备" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#_4">
    模型转换
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_5">
    数据集
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_6">
    标注图片
  </a>
<nav aria-label="标注图片" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#augmentation">
    Augmentation
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_7">
    参数
  </a>
<nav aria-label="参数" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#_8">
    参数设置
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_9">
    脚本重点参数
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_10">
    关键说明
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#instance-prompt-class-prompt">
    解释 Instance Prompt / Class Prompt
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#v">
    关于这个 [V]
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#subject-images-class-images">
    解释 Subject images / Class images
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#native-training">
    Native Training
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_11">
    从检查点恢复训练
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#train-text-encoder">
    Train Text Encoder
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#multiple-concept">
    Multiple Concept
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#aspect-ratio-bucketing">
    Aspect Ratio Bucketing
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_12">
    训练
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#windows">
    在 Windows 上使用
  </a>
<nav aria-label="在 Windows 上使用" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#_13">
    临时指南
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#_14">
    其他 ...
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#dreambooth_1">
    DreamBooth 参数表
  </a>
<nav aria-label="DreamBooth 参数表" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#arguments">
    Arguments
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<a class="md-content__button md-icon" href="https://github.com/sudoskys/StableDiffusionBook/edit/main/docs/train/DreamBooth.md" title="编辑此页">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"></path></svg>
</a>
<h1 id="dreambooth">DreamBooth</h1>
<blockquote>
<p>TODO/HELP 审计</p>
</blockquote>
<h2 id="_1">简介</h2>
<p><a href="https://dreambooth.github.io/">DreamBooth</a> 是一种定制个性化的 TextToImage 扩散模型的方法。仅需少量训练数据就可以获得极佳的效果。</p>
<p>Dreambooth 基于 <a href="https://imagen.research.google/">Imagen</a> 研发，使用时只需将模型导出为 ckpt，然后就可以被加载到各种 UI 中。</p>
<p>然而，Imagen 的模型和预训练的权重都不可用。所以最初的 Dreambooth 并不适用于稳定扩散。但后面 <a href="https://github.com/ShivamShrirao/diffusers">diffusers</a> 实现了 <a href="https://github.com/huggingface/diffusers/tree/main/examples/dreambooth">Dreambooth</a> 这一功能，并且完全适配了 Stable Diffusion。</p>
<blockquote>
<p>Diffusers 提供跨多种模态（例如视觉和音频）的预训练扩散模型，作为扩散模型推理和训练的模块化工具箱提供支持。</p>
</blockquote>
<p>本节使用的是 Shivam Shirao 的 <a href="https://github.com/ShivamShrirao/diffusers/tree/main/examples/dreambooth">diffusers</a> 分支版本，配置衍生自 <a href="https://github.com/ShivamShrirao/diffusers/tree/main/examples/dreambooth">ShivamShrirao/diffusers</a>。</p>
<p>同时推荐 CCRcmcpe 的针对 Stable Diffusion 的 <a href="https://github.com/CCRcmcpe/diffusers/tree/yaml-config">优化分支</a>。</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-width="100%" href="https://dreambooth.github.io/DreamBooth_files/system.png"><img alt="DreamBooth_files" src="https://dreambooth.github.io/DreamBooth_files/system.png"/></a></p>
<blockquote>
<p>by https://dreambooth.github.io/</p>
</blockquote>
<h2 id="_2">选择</h2>
<p>Windows 系统的显存至少需要 16GB, Linux 系统要求显存至少为 8GB</p>
<ul>
<li>
<p>适用于 AutoDl 的 <a href="https://github.com/crosstyan/dreambooth-scripts-for-autodl">DreamBooth 版本</a></p>
</li>
<li>
<p>适用于 AutoDl 的 <a href="https://github.com/CrazyBoyM/dreambooth-for-diffusion">封装镜像</a>，名称为 <code>dreambooth-for-diffusion</code></p>
</li>
<li>
<p>适用于 WebUi 的 <a href="https://github.com/d8ahazard/sd_dreambooth_extension">插件</a></p>
</li>
<li>
<p>适用于 Colab 的 <a href="https://colab.research.google.com/drive/17yM4mlPVOFdJE_81oWBz5mXH9cxvhmz8">Nyanko Lepsoni 的 Colab 笔记本</a></p>
</li>
<li>
<p>适用于 Colab 的 <a href="https://colab.research.google.com/drive/1C1vVZ59S4kWfL7jIsczyLpmxbD4cOA-k">RcINS 的 Colab 笔记本</a></p>
</li>
</ul>
<blockquote>
<p>Colab 笔记本来自 <a href="https://t.me/StableDiffusion_CN/196744">社区置顶</a></p>
</blockquote>
<h2 id="_3">准备</h2>
<p>如果你选择使用 AutoDl 的镜像，需要把 dreambooth-for- diffusion 文件夹移到 autodl-tmp（数据盘）中，且确保运行路径 (# 前面的那一串）为 dreambooth-for-diffusion，具体操作细节在 <a href="https://zhuanlan.zhihu.com/p/584736850">知乎教程</a> 中有图文说明。</p>
<h3 id="_4">模型转换</h3>
<p>在各个笔记本或镜像中都会有以下类型命令，作用是将 ckpt 模型转换为 diffusers 权重格式来训练。</p>
<ul>
<li>训练前示例</li>
</ul>
<div class="highlight"><pre><span></span><code>    python diffusers<span class="se">\s</span>cripts<span class="se">\c</span>onvert_original_stable_diffusion_to_diffusers.py  --checkpoint_path model.ckpt  --original_config_file v1-inference.yaml  --scheduler_type ddim  --dump_path models/diffusers_model
</code></pre></div>
<ul>
<li>训练后示例</li>
</ul>
<p>训练完成后，打包转换为 ckpt 即可用于各种 UI 中。</p>
<div class="highlight"><pre><span></span><code>    python diffusers<span class="se">\s</span>cripts<span class="se">\c</span>onvert_diffusers_to_original_stable_diffusion.py  --model_path models/resultModel  --checkpoint_path result.ckpt  --half
</code></pre></div>
<h3 id="_5">数据集</h3>
<p>数据集的创建是在 Dreambooth 训练 中获得良好、稳定结果的最重要部分。<sup id="fnref:3"><a class="footnote-ref" href="#fn:3">3</a></sup></p>
<p>class 和 instance 的质量决定生成的质量。</p>
<ul>
<li>内容要求</li>
</ul>
<p>一定要使用高质量的样本，运动模糊或低分辨率等内容会被训练到模型里，影响作品质量。</p>
<p>当为一个特定的风格进行训练时，挑选具有良好一致性的样本。理想情况下，只挑选你要训练的艺术家的图像。避免粉丝艺术或任何具有不同风格的东西，除非你的目标是像风格融合。</p>
<p>对于主题，黑色或白色背景的样本有极大的帮助。</p>
<blockquote>
<p>透明的背景也可以，但有时会在主体周围留下白色轮廓，所以目前我不建议使用透明背景。</p>
</blockquote>
<p>如果需要使你的  Dreambooth 模型更加多样化，尽量使用不同的环境、灯光、发型、表情、姿势、角度和与主体的距离。</p>
<p>请确保包括有正常背景的图片（例如，对象在一个场景中的图片）。只使用带简单背景的图片，效果会比较差。</p>
<p>避免在你的渲染图中出现手粘在头上的情况，请删除所有手太靠近或接触头部的图片。</p>
<p>如果需要避免渲染图中出现鱼眼镜头效果，可以删除所有自拍图片。</p>
<p>为了避免不自然的过度模糊，确保图像不包含假的重景深或虚化。</p>
<ul>
<li>调节</li>
</ul>
<p>一旦你收集了数据集的照片，将所有图片裁剪并调整为 512x512 的正方形（你可以利用 <a href="https://www.onlinephotosoft.com/birme/">BIRME</a> 在线工具批量裁剪），并删除任何水印、商标、被图片边缘切断的人/肢体，或其他你不希望被训练的内容。以 PNG 格式保存图像，并将所有图像放在 train 文件夹中。</p>
<h3 id="_6">标注图片</h3>
<p>TODO</p>
<p>你可以手动标注或使用 clip 或 deepdanbooru 进行自动标注。</p>
<p>推荐使用 <a href="https://github.com/crosstyan/blip_helper">crosstyan/blip_helper</a> 去给你的图像打标。或者使用 <a href="https://github.com/KichangKim/DeepDanbooru">DeepDanbooru</a> 和 <a href="https://github.com/salesforce/BLIP">BLIP</a></p>
<p>如果你使用 AutoDl 的镜像，你可以使用内置的 <a href="https://github.com/CrazyBoyM/dreambooth-for-diffusion/blob/main/tools/label_images.py">label_images.py</a> 进行标注。</p>
<h4 id="augmentation">Augmentation</h4>
<ul>
<li>处理数据的方式有许多：最常见的有反转，旋转，亮度和裁切。</li>
</ul>
<blockquote>
<p>将图片打碎，或者对背景/大头等单独裁切，也许会有帮助。</p>
</blockquote>
<h2 id="_7">参数</h2>
<p>先让我们看一下来自 <a href="https://colab.research.google.com/drive/1C1vVZ59S4kWfL7jIsczyLpmxbD4cOA-k">RcINS 的 Colab 笔记本</a> 的一段实例。</p>
<h3 id="_8">参数设置</h3>
<div class="highlight"><pre><span></span><code><span class="nv">INSTANCE_PROMPT</span> <span class="o">=</span> <span class="s2">"masterpiece, best quality, sks 1girl"</span>

<span class="c1"># images of the subject 数据集的图像</span>
<span class="nv">INSTANCE_DIR</span> <span class="o">=</span> <span class="s2">"/content/instance-images"</span>

<span class="c1"># Class set </span>
<span class="nv">CLASS_PROMPT</span> <span class="o">=</span> <span class="s2">"masterpiece, best quality, 1girl"</span> 
<span class="nv">CLASS_NEGATIVE_PROMPT</span> <span class="o">=</span> <span class="s2">"lowres, bad anatomy, bad hands, text, error, missing fingers, extra digit, fewer digits, cropped, worst quality, low quality, normal quality, jpeg artifacts, signature, watermark, username, blurry"</span> 
<span class="nv">CLASS_DIR</span> <span class="o">=</span> <span class="s2">"/content/class-images"</span> 
<span class="nv">NUM_CLASS_IMAGES</span> <span class="o">=</span> <span class="m">100</span> 

<span class="c1"># markdown Prompt for saving samples.</span>
<span class="nv">SAVE_SAMPLE_PROMPT</span> <span class="o">=</span> <span class="s2">"masterpiece, best quality, sks 1girl, looking at viewer"</span>
<span class="nv">SAVE_SAMPLE_NEGATIVE_PROMPT</span> <span class="o">=</span> <span class="s2">"lowres, bad anatomy, bad hands, text, error, missing fingers, extra digit, fewer digits, cropped, worst quality, low quality, normal quality, jpeg artifacts, signature, watermark, username, blurry"</span>
</code></pre></div>
<h3 id="_9">脚本重点参数</h3>
<p><div class="highlight"><pre><span></span><code><span class="nv">wandb_arg</span> <span class="o">=</span> <span class="s2">"--wandb"</span> <span class="k">if</span> WANDB_KEY !<span class="o">=</span> <span class="s2">""</span> <span class="k">else</span> <span class="s2">""</span>
<span class="nv">scale_lr_arg</span> <span class="o">=</span> <span class="s2">"--scale_lr"</span> <span class="k">if</span> SCALE_LR <span class="k">else</span> <span class="s2">""</span>
<span class="nv">ppl_arg</span> <span class="o">=</span> f<span class="s2">"--with_prior_preservation --prior_loss_weight={PRIOR_LOSS_WEIGHT}"</span> <span class="k">if</span> PRIOR_PRESERVATION <span class="k">else</span> <span class="s2">""</span>
<span class="nv">read_prompt_arg</span> <span class="o">=</span> f<span class="s2">"--read_prompt_from_txt {READ_PROMPT_FROM_TXT}"</span> <span class="k">if</span> READ_PROMPT_FROM_TXT !<span class="o">=</span> <span class="s2">"no"</span> <span class="k">else</span> <span class="s2">""</span>
<span class="nv">arb_arg</span> <span class="o">=</span> <span class="s2">"--use_aspect_ratio_bucket --debug_arb"</span> <span class="k">if</span> ASPECT_RATIO_BUCKETING <span class="k">else</span> <span class="s2">""</span>

accelerate launch <span class="nv">$TRAINER</span> <span class="se">\</span>
  --instance_data_dir <span class="s2">"{INSTANCE_DIR}"</span> <span class="se">\</span>
  --instance_prompt <span class="s2">"{INSTANCE_PROMPT}"</span> <span class="se">\</span>
  --pretrained_model_name_or_path <span class="s2">"{MODEL_NAME}"</span> <span class="se">\</span>
  --pretrained_vae_name_or_path <span class="s2">"{MODEL_NAME}/vae"</span> <span class="se">\</span>
  --output_dir <span class="s2">"{OUTPUT_DIR}"</span> <span class="se">\</span>
  --seed<span class="o">=</span><span class="nv">$SEED</span> <span class="se">\</span>
  --resolution<span class="o">=</span><span class="nv">$RESOLUTION</span> <span class="se">\</span>
  --optimizer <span class="s2">"{OPTIMIZER}"</span> <span class="se">\</span>
  --train_batch_size<span class="o">=</span><span class="nv">$TRAIN_BATCH_SIZE</span> <span class="se">\</span>
  --learning_rate<span class="o">=</span><span class="nv">$LEARNING_RATE</span> <span class="se">\</span>
  --lr_scheduler<span class="o">=</span><span class="nv">$LR_SCHEDULER</span> <span class="se">\</span>
  --lr_warmup_steps<span class="o">=</span><span class="nv">$LR_WARMUP_STEPS</span> <span class="se">\</span>
  --lr_cycles<span class="o">=</span><span class="nv">$LR_CYCLES</span> <span class="se">\</span>
  --last_epoch<span class="o">=</span><span class="nv">$LAST_EPOCH</span> <span class="se">\</span>
  --max_train_steps<span class="o">=</span><span class="nv">$MAX_TRAIN_STEPS</span> <span class="se">\</span>
  --save_interval<span class="o">=</span><span class="nv">$SAVE_INTERVAL</span> <span class="se">\</span>
  --class_data_dir <span class="s2">"{CLASS_DIR}"</span> <span class="se">\</span>
  --class_prompt <span class="s2">"{CLASS_PROMPT}"</span> --class_negative_prompt <span class="s2">"{CLASS_NEGATIVE_PROMPT}"</span> <span class="se">\</span>
  --num_class_images<span class="o">=</span><span class="nv">$NUM_CLASS_IMAGES</span> <span class="se">\</span>
  --save_sample_prompt <span class="s2">"{SAVE_SAMPLE_PROMPT}"</span> --save_sample_negative_prompt <span class="s2">"{SAVE_SAMPLE_NEGATIVE_PROMPT}"</span> <span class="se">\</span>
  --n_save_sample<span class="o">=</span><span class="nv">$SAMPLE_N</span> <span class="se">\</span>
  --infer_batch_size<span class="o">=</span><span class="nv">$INFER_BATCH_SIZE</span> <span class="se">\</span>
  --infer_steps<span class="o">=</span><span class="nv">$INFER_STEPS</span> <span class="se">\</span>
  --guidance_scale<span class="o">=</span><span class="nv">$GUIDANCE_SCALE</span> <span class="se">\</span>
  --gradient_accumulation_steps<span class="o">=</span><span class="nv">$GRADIENT_ACCUMULATION_STEPS</span> <span class="se">\</span>
  --gradient_checkpointing <span class="se">\</span>
  --save_unet_half <span class="se">\</span>
  --mixed_precision <span class="s2">"{MIXED_PRECISION}"</span> <span class="se">\</span>
  --clip_skip<span class="o">=</span><span class="nv">$CLIP_SKIP</span> <span class="se">\</span>
  <span class="nv">$wandb_arg</span> <span class="nv">$scale_lr_arg</span> <span class="nv">$ppl_arg</span> <span class="nv">$read_prompt_arg</span> <span class="nv">$arb_arg</span>

<span class="c1"># disabled: --not_cache_latents </span>
</code></pre></div>
* Instance Image </p>
<p>你所训练的目标数据集。</p>
<ul>
<li>Class/Regularization </li>
</ul>
<p>无需过分关心，Image 应该为 自动生成 即 auto-generated 的图像，用于检测 AI 的先验知识。不应该放任何非 AI 生成的图像。如果你确定这么做应该去使用 Native Training。（掺杂同风格图在 clas image 属于早期探索的弯路，目前已经不再鼓励）</p>
<ul>
<li>learning_rate 学习率</li>
</ul>
<p>DreamBooth 本身具有十分强烈的 copy and paste 效果。使用 class/regularization 可以适当压制该效果。</p>
<ul>
<li>use_txt_as_label</li>
</ul>
<p>是否读取与图片同名的 txt 文件作为 label。该选项会忽略 <code>instance_prompt</code> 参数传入的内容。通常在风格训练中使用。</p>
<ul>
<li>center_crop </li>
</ul>
<p>脚本自带的裁切图片选项，建议自己裁成正方形的哦。</p>
<ul>
<li>resolution </li>
</ul>
<p>图片的分辨率（一般为 512)，定义此参数会缩放图像。</p>
<ul>
<li>max_train_steps</li>
</ul>
<p>训练的最大步数，一般是 1000，如果你的数据集比较大，那么可以适当增大该值。</p>
<p>训练步数的选择一般来说是，训练步骤 =（参考图像 x 100）</p>
<ul>
<li>save_model_every_n_steps</li>
</ul>
<p>每多少步保存一次模型，方便查看中间训练的结果找出最优的模型，也可以用于从检查点恢复上一次的训练结果（colab 笔记本用户注意挂载到云盘中）。</p>
<ul>
<li>lr_scheduler</li>
</ul>
<p>学习率调节器，可选有 <code>constant, linear, cosine, cosine_with_restarts, cosine_with_hard_restarts</code></p>
<ul>
<li>with_prior_preservation</li>
</ul>
<p>启用 prior_preservation 以开始 DreamBooth 训练，禁用来开启 Native Training。</p>
<ul>
<li>prior_loss_weight </li>
</ul>
<p>越低则越难过拟合，但是也越难学到东西。<sup id="fnref:4"><a class="footnote-ref" href="#fn:4">4</a></sup><sup id="fnref2:3"><a class="footnote-ref" href="#fn:3">3</a></sup> </p>
<h3 id="_10">关键说明</h3>
<p>一般训练画风会去除 <code>--with_prior_preservation</code> 参数，但是需要为每张待训练图片都准备提示，也就是启用 <code>--use_txt_as_label</code> 来读取与图片同名的 txt 文件作为 label（也就是再放一个同名的 txt)，该选项会忽略 instance_prompt 参数传入的内容。
这点体现在 <a href="https://github.com/CrazyBoyM/dreambooth-for-diffusion/blob/main/train_style.sh">train_style.sh</a> 中。</p>
<p>一般训练特定物体/人物是启用 <code>--with_prior_preservation</code> 的只需要使用单一标签 <code>--instance_prompt</code>，需要使用 Ai 的先验知识，同时 启用 <code>--class_prompt</code> <code>--class_data_dir</code> 参数 ，<strong>Class dir 是自动生成的</strong>，每次重新训练要清空一次。体现在 <a href="https://github.com/CrazyBoyM/dreambooth-for-diffusion/blob/main/train_object.sh">train_object.sh</a> 中。</p>
<p>不要使用默认的 by sks(sks 这个艺术家）, 融合模型的时候会发生灾难。</p>
<p>下面是一些零零散散的解释。</p>
<h3 id="instance-prompt-class-prompt">解释 Instance Prompt / Class Prompt</h3>
<ul>
<li>Instance Prompt </li>
</ul>
<p>默认实现为全局共享一个 prompt, 这对于 few shot 是可能有效的，即 DreamBooth (original paper method)。</p>
<p>但是，当你的训练目标增多之后此参数不再适用，可以开启 <code>combine_prompt_from_txt</code> 选项，为每个 instance 准备一个 prompt （通常为 txt) 即为 DreamBooth (alternative method). Instance Prompt 之中应该包含一个唯一标识符 [V]</p>
<ul>
<li>Class Prompt</li>
</ul>
<p>无需过分关心，是自动生成出来的，建议从其他支持 CLIP SKIP 2 的推理前端单独生成好之后丢到 class img 集内，同样可以从独立的 txt 中读取内容。</p>
<ul>
<li>说明</li>
</ul>
<p>class prompt 会用来生成一类图片，被处理为类似 <code>photo of a person</code></p>
<p>instance prompt 会被处理为类似 <code>photo of a cute person</code></p>
<ul>
<li>示例</li>
</ul>
<p><em>训练人物的示例</em>
* Instance prompt: <code>masterpiece, best quality, sks 1girl, aqua eyes, aqua hair</code>
* Class prompt: <code>masterpiece, best quality, 1girl, aqua eyes, aqua hair</code></p>
<p><em>训练风格的示例</em>
* Instance prompt: <code>1girl, by sks</code>
* Class prompt: <code>1girl</code></p>
<h3 id="v">关于这个 [V]</h3>
<table>
<thead>
<tr>
<th>What your training set is about</th>
<th>Instance prompt must contain</th>
<th>Class prompt should describe</th>
</tr>
</thead>
<tbody>
<tr>
<td>A object/person</td>
<td><code>[V]</code></td>
<td>The object's type and/or characteristics</td>
</tr>
<tr>
<td>A artist's style</td>
<td><code>by [V]</code></td>
<td>The common characteristics of the training set</td>
</tr>
</tbody>
</table>
<p>[V] 是 CLIP 词汇表中的标记，对模型没有意义。</p>
<p>假设你想训练的人物叫做 <code>[N]</code>（比如 <code>balabalabala 先生</code>) , 你不应该直接使用 <code>[N]</code>(<code>balabalabala 先生</code>) 作为代表特征词。</p>
<p>推荐使用在 <a href="https://huggingface.co/openai/clip-vit-large-patch14/raw/main/vocab.json">该词汇表</a> 中存在但是没有对应概念或者说对应概念不明显的词 <code>[V]</code>（比如 <code>bala</code>)。</p>
<p>长长的名称很可能被分离为多个标记，会得不到预期效果。标记的分离情况具体可在 <a href="https://novelai.net/tokenizer">NovelAI Tokenizer</a> 验证。</p>
<p>最后代表 [V] 的提示将携带模型学到的新东西，你就可以在生成时使用你设定的 [V] 了。</p>
<blockquote>
<p>注：原论文中使用的示例词 <code>sks</code> 和现实中的枪械 <a href="https://en.wikipedia.org/wiki/SKS">SKS</a> 相同，属于不适合被使用的词汇。但是如果你的训练程度足够高的话说不定可以覆写其影响。</p>
</blockquote>
<h3 id="subject-images-class-images">解释 Subject images / Class images</h3>
<p>介绍来自 <sup id="fnref:2"><a class="footnote-ref" href="#fn:2">2</a></sup></p>
<p>Subject images （或者你在笔记本上看到的实例图像）是你想要训练的图像，所以如果你想要自己的外观的模型，你可以取 20 到 40 张自己的图像并输入这些图像。实例名是一个唯一的标识符，它将在提示符中表示受训对象，个人使用 “namelastname”，大多数笔记本使用“sks”，但最好更改它。</p>
<p>你实际上是在告诉 AI 把你介绍到数据库中，为了做到这一点，你选择一个类别，即最适合你所训练的类别，对于人们来说，通常使用 "person", "man"/"woman" 等。</p>
<p>在训练中使用 Class images 是为了 <strong>防止物体的特征 “渗透” 到同一 Class 的其他物体中</strong>。如果没有 Class images 作为参考点，AI 会将你的脸与 Class 中出现的其他脸合并。<strong>你的脸会渗透进模型生成的其他脸中。</strong></p>
<p>DreamBooth 可以在没有 Class images 的情况下开始训练，只需要禁用 <code>--with_prior_preservation</code> 来开启 Native Training.</p>
<h3 id="native-training">Native Training</h3>
<p>Native Training 为原生训练，与 DreamBooth 不同的是，Native Training 会直接使用你的训练集进行训练，不再需要 Class Image.</p>
<p>关闭 <code>prior_preservation</code> 选项（也就是 <code>--with_prior_preservation</code> 参数）以开始以原生方式进行训练，是训练画风的推荐方式。</p>
<p>在此训练中没有 Instance/Class Image 之分，所有的图像都会被用于训练。但是你需要为每个图准备一个 Instance Prompt, 就像传统的 hypernetwork 一样同文件名称，通常为 txt.</p>
<div class="admonition tip">
<p class="admonition-title">关于这个 Txt</p>
<p>对于数据集中的每张图片（[X].png/[X].jpg），再放一个包含相应提示的 [X].txt。然后设置 <code>READ_PROMPT_FROM_TXT</code>（ <code>--use_txt_as_label</code> ）。Both train set and class set supports this.</p>
<p>从 txt [PX] 中读取的提示将被插入到你在训练参数中设置的提示 [P] 中。默认情况下，它的插入方式是 [PX][P]。</p>
<p>在启用 Variable Prompts 和禁用先前保存损失 (PRIOR_PRESERVATION) 的情况下，训练过程实际上等同于标准微调。</p>
</div>
<p>Native Training 需要较多的数据集，但这个量众说纷纭，大约在 [100, 10000] 这个区间，多多益善。（建议人工挑选）</p>
<h3 id="_11">从检查点恢复训练</h3>
<p>参数的 MODEL_NAME 改成上一次模型的位置。</p>
<p>如果你用到 <code>CLASS_DIR</code> ，因为主题相同，所以不必清空，反之则清空。</p>
<h3 id="train-text-encoder">Train Text Encoder</h3>
<p>对应实例中的 <code>--train_text_encoder</code>，不推荐使用。使用 <code>--train_text_encoder</code> 后，Dreambooth 训练会额外训练文本编码器，会让不同模型之间的 prompt 无法通用。</p>
<p>有玄学说法是在达到训练的某个百分比/epoch/step 之后应该关闭以防止过度玩坏。</p>
<ul>
<li>你一开始写的 instance prompt 要长一些，概括你的训练目标 （但是又不要太长，不要覆盖你常用的词） （像是 girl 我会换成 woman, 1boy 换成 male)</li>
<li>第一，text prompt 读进去是寄。因为词数太多了影响分散，效果不明显。</li>
<li>第二，instance prompt 不能只填一个 <code>[V]</code> 否则那个词也废掉了。</li>
<li>试着大火爆炒</li>
</ul>
<p>炼出来调用的话看情况加你训练的 instance prompt 的词，看你想要多少味道。</p>
<p>或许训练人物的时候也是效果拔群。</p>
<h3 id="multiple-concept">Multiple Concept</h3>
<p>对应实例中的 <code>--concept_list</code> 参数，用 DreamBooth 是可以训练多个概念/人物/动作/物体的。但是若训练两个人物则推理时不能使其同时出现，两者的特征会被混合起来。</p>
<p>如果用其他版本的 DreamBooth 训练方法检查 <code>--concept_list</code> 参数，可以读入一个类似的 <code>json</code> 文件。</p>
<ul>
<li>concepts_list.json</li>
</ul>
<div class="highlight"><pre><span></span><code># You can also add multiple concepts here. Try tweaking `--max_train_steps` accordingly.

concepts_list = [
    {
        "instance_prompt":      "photo of zwx dog",
        "class_prompt":         "photo of a dog",
        "instance_data_dir":    "/content/data/zwx",
        "class_data_dir":       "/content/data/dog"
    },
#     {
#         "instance_prompt":      "photo of ukj person",
#         "class_prompt":         "photo of a person",
#         "instance_data_dir":    "/content/data/ukj",
#         "class_data_dir":       "/content/data/person"
#     }
]

# `class_data_dir` contains regularization images
</code></pre></div>
<h3 id="aspect-ratio-bucketing">Aspect Ratio Bucketing</h3>
<p>对应上面参数中的 <code>--use_aspect_ratio_bucket</code>。需要在 Colab 中使用的话，<code>aspect_ratio_bucket</code> 调成 <code>enable: true</code>。</p>
<p><a href="https://github.com/NovelAI/novelai-aspect-ratio-bucketing">Aspect Ratio Bucketing</a> 简称 ARB, 原版训练均只能使用 <code>1:1</code> 的图像，开启 ARB 使得训练非 <code>1:1</code> 的图像成为可能，但并非任意比例尺的图像，不在 bucket 内的图像将会被裁切。</p>
<div class="highlight"><pre><span></span><code>[[ 256 1024], [ 320 1024], [ 384 1024], [ 384  960], [ 384  896], [ 448  832], [ 512  768], [ 512  704], [ 512  512], [ 576  640], [ 640  576], [ 704  512], [ 768  512], [ 832  448], [ 896  384], [ 960  384], [1024  384], [1024  320], [1024  256]]
</code></pre></div>
<blockquote>
<p>ARB 与 DreamBooth 一起使用的兼容性不好，仅推荐 Native Training 时使用。</p>
</blockquote>
<p>更多内容请查阅 <a href="https://wandb.ai/psuraj/dreambooth/reports/Dreambooth-training-analysis--VmlldzoyNzk0NDc3">使用 Dreambooth 训练稳定扩散的实验的分析</a></p>
<h2 id="_12">训练</h2>
<p>按照笔记本步骤或说明训练即可，Colab 用户注意挂载磁盘防止断线。</p>
<p>训练完毕要将 diffusers 权重转换为 ckpt 文件才能使用哦！利用类似 <code>diffusers2ckpt.py</code> 的文件即可。</p>
<blockquote>
<p>有些脚本提供 <code>--half</code> 参数用来保存 float16 半精度模型，权重文件大小会减半（约 2g），但效果基本一致。</p>
</blockquote>
<p>WebUi 用户将训练出的 <code>.ckpt</code> 文件复制到 webui 的 <code>models\Stable-diffusion</code> 目录里，在 webui 的左上角切换模型即可使用。</p>
<p>使用时在 <code>prompt</code> 里输入你之前指定的标志符（例如 <balabala> ) 来让 ai 在生成图像中加入你期待的东西。</balabala></p>
<blockquote>
<p>过拟合后，CFG 影响很大，可以试试降低 CFG.</p>
</blockquote>
<p>模型的效果要看测试图。</p>
<h2 id="windows">在 Windows 上使用</h2>
<p>这里的内容适用于想在 Windows 系统上进行训练的同学。</p>
<p>来自 [^18]</p>
<p>Windows 上的 <code>Dreambooth</code> 可以采用 ShivamShrirao 的优化版本来节省显存，<a href="https://github.com/ShivamShrirao/diffusers/tree/main/examples/dreambooth">diffusers/examples/dreambooth </a> by ShivamShrirao.</p>
<p>由于相关链接库的原因，用于在 <code>Linux</code> 上的部署方法无法直接在 windows 上使用，由于同样的原因，该优化版本在 colab 上最低 9.9G 的显存需求在 windows 上应该稍高，因此推荐 <strong>至少使用显存 12G</strong> 的显卡。</p>
<blockquote>
<p>编纂者仅在 16G 显存的机器上测试成功，12G 显存的机器理论可行。</p>
</blockquote>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>修改或覆盖原始库中的文件时，请备份。</p>
</div>
<p>准备环境 <code>Git</code> ， <code>Python</code> ， <code>MiniConda</code> （或 <code>MiniConda</code> )。</p>
<p>以下步骤在 python3.8，windows10 22H2 中操作，其他环境未测试</p>
<p><strong>创建工作目录 ，在目录下构建 python3.8 的 venv 虚拟环境</strong></p>
<div class="highlight"><pre><span></span><code>    python -m venv --system-site-packages venv_dbwin
    venv_dbwin<span class="se">\S</span>cripts<span class="se">\a</span>ctivate
    python.exe -m pip install --upgrade pip
</code></pre></div>
<p>克隆 ShivamShrirao 的优化版本 dreambooth 到工作目录中并安装相关依赖（使用的 <a href="https://github.com/huggingface/diffusers/tree/7465397f33d5de75dcccc155e3fb9a232fcbb0a0">构建版本</a>, 后续版本可能无法支持本文方法）</p>
<div class="highlight"><pre><span></span><code>git clone https://github.com/ShivamShrirao/diffusers
<span class="nb">cd</span> diffusers
pip install -e .
<span class="nb">cd</span> examples<span class="se">\d</span>reambooth
pip install -U -r requirements.txt
pip install OmegaConf
pip install pytorch_lightning
pip install einops
pip install <span class="nv">bitsandbytes</span><span class="o">==</span><span class="m">0</span>.34
</code></pre></div>
<p>完成后，在 windows 上需要根据 <a href="https://github.com/TimDettmers/bitsandbytes/issues/30#issuecomment-1257676341">这个 Issue</a> 中的方法实现 bitsandbytes 支持</p>
<p>将 <a href="https://github.com/DeXtmL/bitsandbytes-win-prebuilt">这个仓库</a> 中的 <code>libbitsandbytes_cuda116.dll</code> 文件手动拷贝到工作目录下的 <code>venv_diffusers\Lib\site-packages\bitsandbytes</code> 中，位于 <code>libbitsandbytes_cuda116.so</code> 的旁边；</p>
<p>然后更改脚本以应用，可以手动修改，为方便也可以下载以下文件替换：</p>
<p>将 <code>cextension.py</code> - https://pastebin.com/jjgxuh8V 覆盖到 <code>venv_diffusers\Lib\site-packages\bitsandbytes</code> 目录。</p>
<p>将 <code>main.py</code> - https://pastebin.com/BsEzpdpw 覆盖到 <code>venv_diffusers\Lib\site-packages\bitsandbytes\cuda_setup</code> 目录。</p>
<p><strong>安装 PyTorch 和 Torchvision</strong></p>
<p><code>pip install torch==1.12.1+cu116 torchvision==0.13.1+cu116 --extra-index-url https://download.pytorch.org/whl/cu116</code></p>
<p><strong>进入 Python 并测试调用</strong></p>
<div class="highlight"><pre><span></span><code>    python
    &gt;&gt;&gt;import bitsandbytes
</code></pre></div>
<p>如果没有报错证明安装成功（ <code>Ctrl + Z</code> 并回车退出 python）。</p>
<h4 id="_13">临时指南</h4>
<p><strong>设置 accelerate</strong></p>
<div class="highlight"><pre><span></span><code>    accelerate config

    In which compute environment are you running? ([0] This machine, [1] AWS (Amazon SageMaker)): 0
    Which type of machine are you using? ([0] No distributed training, [1] multi-CPU, [2] multi-GPU, [3] TPU [4] MPS): 0
    Do you want to run your training on CPU only (even if a GPU is available)? [yes/NO]:NO
    Do you want to use DeepSpeed? [yes/NO]:NO
    Do you wish to use FP16 or BF16 (mixed precision)? [NO/fp16/bf16]: fp16
</code></pre></div>
<p>按照上面的设置选项，也就是（0，0，NO，NO，fp16）。</p>
<p><strong>修改显存优化</strong></p>
<p>因为无法使用 xformers ，所以使用 <a href="https://github.com/lucidrains/memory-efficient-attention-pytorch/blob/main/memory_efficient_attention_pytorch/flash_attention.py">此文件</a> 中的优化方法作为代替。</p>
<p>将 attention.py -  https://pastebin.com/nmwTrGB9 覆盖到 <code>diffusers\src\diffusers\models</code> 目录。</p>
<p>至此环境配置完成，可以开始训练了。具体使用参数请查阅 ShivamShrirao 的 readme 文件和 notebook 文件。</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>我使用以下参数训练。</p>
</div>
<div class="highlight"><pre><span></span><code>        accelerate launch --num_cpu_threads_per_process <span class="m">8</span> diffusers/examples/dreambooth/train_dreambooth.py --pretrained_model_name_or_path<span class="o">=</span>models/diffusers_model --pretrained_vae_name_or_path<span class="o">=</span>models/diffusers_model/vae --output_dir<span class="o">=</span>models --concepts_list<span class="o">=</span><span class="s2">"concepts_list.json"</span> --with_prior_preservation --prior_loss_weight<span class="o">=</span><span class="m">1</span>.0 --seed<span class="o">=</span><span class="m">1337</span> --resolution<span class="o">=</span><span class="m">512</span> --mixed_precision<span class="o">=</span><span class="s2">"fp16"</span> --lr_scheduler<span class="o">=</span><span class="s2">"constant"</span> --use_8bit_adam --gradient_accumulation_steps<span class="o">=</span><span class="m">1</span> --train_batch_size<span class="o">=</span><span class="m">1</span> --max_train_steps<span class="o">=</span><span class="m">800</span> --save_interval<span class="o">=</span><span class="m">10000</span> --learning_rate<span class="o">=</span>1e-6 --num_class_images<span class="o">=</span><span class="m">100</span> --lr_warmup_steps<span class="o">=</span><span class="m">0</span> --gradient_checkpointing
</code></pre></div>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-width="100%" href="https://user-images.githubusercontent.com/44570237/198906326-21b4f779-f870-4012-84c1-d5ac1dae0411.png"><img alt="image" src="https://user-images.githubusercontent.com/44570237/198906326-21b4f779-f870-4012-84c1-d5ac1dae0411.png"/></a></p>
<p>峰值显存占用正好为 12G，如果您只有一个显卡，显存不高于 12G，而且同时需要用于 Windows 系统显示，请关闭所有占用显存的程序或网页等，减少额外显存消耗再进行训练。</p>
<p>diffusers 不能直接使用 ckpt 文件进行训练，需要先进行转换，示例如下。</p>
<div class="highlight"><pre><span></span><code>    python diffusers<span class="se">\s</span>cripts<span class="se">\c</span>onvert_original_stable_diffusion_to_diffusers.py  --checkpoint_path model.ckpt  --original_config_file v1-inference.yaml  --scheduler_type ddim  --dump_path models/diffusers_model
</code></pre></div>
<p>训练完成同样要进行打包转换为 ckpt, 即可用于 AUTOMATIC1111 的 WebUI 中。</p>
<div class="highlight"><pre><span></span><code>    python diffusers\scripts\convert_diffusers_to_original_stable_diffusion.py  --model_path models/resultModel  --checkpoint_path result.ckpt  --half
</code></pre></div>
<blockquote>
<p>这是一个临时的解决方案，期待 Windows 官方适配的到来。</p>
</blockquote>
<h2 id="_14">其他 ...</h2>
<p><a href="https://github.com/TheLastBen/fast-stable-diffusion">fast-stable-diffusion colabs</a></p>
<p><a href="https://colab.research.google.com/github/ShivamShrirao/diffusers/blob/main/examples/dreambooth/DreamBooth_Stable_Diffusion.ipynb#scrollTo=K6xoHWSsbcS3">DreamBooth_Stable_Diffusion</a> </p>
<p><a href="https://colab.research.google.com/github/TheLastBen/fast-stable-diffusion/blob/main/fast-DreamBooth.ipynb">fast-DreamBooth</a></p>
<p><a href="https://github.com/AUTOMATIC1111/stable-diffusion-webui/discussions/2927">Dreambooth Gui</a></p>
<h2 id="dreambooth_1">DreamBooth 参数表</h2>
<div class="highlight"><pre><span></span><code>usage: argmark <span class="o">[</span>-h<span class="o">]</span> --pretrained_model_name_or_path
               PRETRAINED_MODEL_NAME_OR_PATH <span class="o">[</span>--revision REVISION<span class="o">]</span>
               <span class="o">[</span>--tokenizer_name TOKENIZER_NAME<span class="o">]</span> --instance_data_dir
               INSTANCE_DATA_DIR <span class="o">[</span>--class_data_dir CLASS_DATA_DIR<span class="o">]</span>
               <span class="o">[</span>--instance_prompt INSTANCE_PROMPT<span class="o">]</span>
               <span class="o">[</span>--class_prompt CLASS_PROMPT<span class="o">]</span>
               <span class="o">[</span>--with_prior_preservation<span class="o">]</span>
               <span class="o">[</span>--prior_loss_weight PRIOR_LOSS_WEIGHT<span class="o">]</span>
               <span class="o">[</span>--num_class_images NUM_CLASS_IMAGES<span class="o">]</span>
               <span class="o">[</span>--output_dir OUTPUT_DIR<span class="o">]</span> <span class="o">[</span>--seed SEED<span class="o">]</span>
               <span class="o">[</span>--resolution RESOLUTION<span class="o">]</span> <span class="o">[</span>--center_crop<span class="o">]</span>
               <span class="o">[</span>--use_filename_as_label<span class="o">]</span> <span class="o">[</span>--use_txt_as_label<span class="o">]</span>
               <span class="o">[</span>--train_text_encoder<span class="o">]</span>
               <span class="o">[</span>--train_batch_size TRAIN_BATCH_SIZE<span class="o">]</span>
               <span class="o">[</span>--sample_batch_size SAMPLE_BATCH_SIZE<span class="o">]</span>
               <span class="o">[</span>--num_train_epochs NUM_TRAIN_EPOCHS<span class="o">]</span>
               <span class="o">[</span>--max_train_steps MAX_TRAIN_STEPS<span class="o">]</span>
               <span class="o">[</span>--gradient_accumulation_steps GRADIENT_ACCUMULATION_STEPS<span class="o">]</span>
               <span class="o">[</span>--gradient_checkpointing<span class="o">]</span>
               <span class="o">[</span>--learning_rate LEARNING_RATE<span class="o">]</span> <span class="o">[</span>--scale_lr<span class="o">]</span>
               <span class="o">[</span>--lr_scheduler LR_SCHEDULER<span class="o">]</span>
               <span class="o">[</span>--lr_warmup_steps LR_WARMUP_STEPS<span class="o">]</span> <span class="o">[</span>--use_8bit_adam<span class="o">]</span>
               <span class="o">[</span>--adam_beta1 ADAM_BETA1<span class="o">]</span> <span class="o">[</span>--adam_beta2 ADAM_BETA2<span class="o">]</span>
               <span class="o">[</span>--adam_weight_decay ADAM_WEIGHT_DECAY<span class="o">]</span>
               <span class="o">[</span>--adam_epsilon ADAM_EPSILON<span class="o">]</span>
               <span class="o">[</span>--max_grad_norm MAX_GRAD_NORM<span class="o">]</span> <span class="o">[</span>--push_to_hub<span class="o">]</span>
               <span class="o">[</span>--hub_token HUB_TOKEN<span class="o">]</span> <span class="o">[</span>--hub_model_id HUB_MODEL_ID<span class="o">]</span>
               <span class="o">[</span>--logging_dir LOGGING_DIR<span class="o">]</span>
               <span class="o">[</span>--log_with <span class="o">{</span>tensorboard,wandb<span class="o">}]</span>
               <span class="o">[</span>--mixed_precision <span class="o">{</span>no,fp16,bf16<span class="o">}]</span>
               <span class="o">[</span>--local_rank LOCAL_RANK<span class="o">]</span>
               <span class="o">[</span>--save_model_every_n_steps SAVE_MODEL_EVERY_N_STEPS<span class="o">]</span>
               <span class="o">[</span>--auto_test_model<span class="o">]</span> <span class="o">[</span>--test_prompt TEST_PROMPT<span class="o">]</span>
               <span class="o">[</span>--test_prompts_file TEST_PROMPTS_FILE<span class="o">]</span>
               <span class="o">[</span>--test_negative_prompt TEST_NEGATIVE_PROMPT<span class="o">]</span>
               <span class="o">[</span>--test_seed TEST_SEED<span class="o">]</span>
               <span class="o">[</span>--test_num_per_prompt TEST_NUM_PER_PROMPT<span class="o">]</span>
</code></pre></div>
<h3 id="arguments">Arguments</h3>
<p>英文说明在英文页面。</p>
<table>
<thead>
<tr>
<th align="left">short</th>
<th align="left">long</th>
<th align="left">default</th>
<th align="left">help</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>-h</code></td>
<td align="left"><code>--help</code></td>
<td align="left"></td>
<td align="left">显示此帮助信息并退出</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"><code>--pretrained_model_name_or_path</code></td>
<td align="left"><code>None</code></td>
<td align="left">预训练模型的路径或来自 huggingface.co/models 的模型标识符。</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"><code>--revision</code></td>
<td align="left"><code>None</code></td>
<td align="left">修订来自 huggingface.co/models 的预训练模型标识。</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"><code>--tokenizer_name</code></td>
<td align="left"><code>None</code></td>
<td align="left">预训练的标记器名称或路径，如果与 model_name 不相同的话。</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"><code>--instance_data_dir</code></td>
<td align="left"><code>None</code></td>
<td align="left">一个包含实例图像训练数据的文件夹。</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"><code>--class_data_dir</code></td>
<td align="left"><code>None</code></td>
<td align="left">一个包含类图像训练数据的文件夹。</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"><code>--instance_prompt</code></td>
<td align="left"><code>None</code></td>
<td align="left">带有指定实例的标识符的提示</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"><code>--class_prompt</code></td>
<td align="left"><code>None</code></td>
<td align="left">提示指定与提供的实例图像相同类别的图像。</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"><code>--with_prior_preservation</code></td>
<td align="left"></td>
<td align="left">标记，以增加先前的保存损失。</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"><code>--prior_loss_weight</code></td>
<td align="left"><code>1.0</code></td>
<td align="left">The weight of prior preservation loss.</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"><code>--num_class_images</code></td>
<td align="left"><code>100</code></td>
<td align="left">用于事先保存损失的最小的类图像。如果没有足够的图像，额外的图像将用 class_prompt 进行采样。</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"><code>--output_dir</code></td>
<td align="left"><code>text-inversion-model</code></td>
<td align="left">输出目录，模型预测和 checkpoints 将被写入该目录。</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"><code>--seed</code></td>
<td align="left"><code>None</code></td>
<td align="left">可重复的培训的种子。</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"><code>--resolution</code></td>
<td align="left">512`</td>
<td align="left">输入图像的分辨率，训练/验证数据集中的所有图像将被调整到这个分辨率。</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"><code>--center_crop</code></td>
<td align="left"></td>
<td align="left">是否在调整图像大小至分辨率前居中裁剪图像？</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"><code>--use_filename_as_label</code></td>
<td align="left"></td>
<td align="left">使用文件名作为图像标签而不是 instance_prompt，在训练图像差异较大的样式时对正则化很有用</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"><code>--use_txt_as_label</code></td>
<td align="left"></td>
<td align="left">使用 filename.txt 文件的内容作为图像标签而不是 instance_prompt，在训练图像差异较大的样式时对正则化很有用</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"><code>--train_text_encoder</code></td>
<td align="left"></td>
<td align="left">是否训练文本编码器</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"><code>--train_batch_size</code></td>
<td align="left"><code>4</code></td>
<td align="left">训练数据加载器的批量大小（每个设备）。</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"><code>--sample_batch_size</code></td>
<td align="left"><code>4</code></td>
<td align="left">采样图像的批量大小（每个设备）。</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"><code>--num_train_epochs</code></td>
<td align="left"><code>1</code></td>
<td align="left"><code>None</code></td>
</tr>
<tr>
<td align="left"></td>
<td align="left"><code>--max_train_steps</code></td>
<td align="left"><code>None</code></td>
<td align="left">要执行的训练步骤总数。 如果提供，则覆盖 num_train_epochs。</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"><code>--gradient_accumulation_steps</code></td>
<td align="left"><code>1</code></td>
<td align="left">执行向后/更新传递之前要累积的更新步数。</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"><code>--gradient_checkpointing</code></td>
<td align="left"></td>
<td align="left">是否使用梯度检查点来以较慢的反向传递为代价来节省内存。</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"><code>--learning_rate</code></td>
<td align="left"><code>5e-06</code></td>
<td align="left">要使用的初始学习率（在潜在的预热期之后）。</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"><code>--scale_lr</code></td>
<td align="left"></td>
<td align="left">通过 GPU 数量、梯度累积步长和批量大小来缩放学习率。</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"><code>--lr_scheduler</code></td>
<td align="left"><code>constant</code></td>
<td align="left">The scheduler type to use. Choose between ["linear", "cosine", "cosine_with_restarts", "polynomial", "constant", "constant_with_warmup"]</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"><code>--lr_warmup_steps</code></td>
<td align="left"><code>500</code></td>
<td align="left">lr 调度程序中预热的步骤数。</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"><code>--use_8bit_adam</code></td>
<td align="left"></td>
<td align="left">是否使用 bitsandbytes 中的 8 位 Adam。</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"><code>--adam_beta1</code></td>
<td align="left"><code>0.9</code></td>
<td align="left">Adam 优化器的 beta1 参数。</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"><code>--adam_beta2</code></td>
<td align="left"><code>0.999</code></td>
<td align="left">Adam 优化器的 beta2 参数。</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"><code>--adam_weight_decay</code></td>
<td align="left"><code>0.01</code></td>
<td align="left">要使用的权重衰减。</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"><code>--adam_epsilon</code></td>
<td align="left"><code>1e-08</code></td>
<td align="left">Adam 优化器的 Epsilon 值</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"><code>--max_grad_norm</code></td>
<td align="left"><code>1.0</code></td>
<td align="left">最大梯度范数。</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"><code>--push_to_hub</code></td>
<td align="left"></td>
<td align="left">是否将模型推送到 Hub。</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"><code>--hub_token</code></td>
<td align="left"><code>None</code></td>
<td align="left">用于推送到模型中心的令牌。</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"><code>--hub_model_id</code></td>
<td align="left"><code>None</code></td>
<td align="left">要与本地 <code>output_dir</code> 保持同步的存储库名称。</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"><code>--logging_dir</code></td>
<td align="left"><code>logs</code></td>
<td align="left"><a href="https://www.tensorflow.org/tensorboard">TensorBoard</a> log directory. Will default to <em>output_dir/runs/</em> <em>CURRENT_DATETIME_HOSTNAME</em>**.</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"><code>--log_with</code></td>
<td align="left"><code>tensorboard</code></td>
<td align="left"><code>None</code></td>
</tr>
<tr>
<td align="left"></td>
<td align="left"><code>--mixed_precision</code></td>
<td align="left"><code>no</code></td>
<td align="left">是否使用混合精度。 在 fp16 和 bf16 (bfloat16) 之间选择。 Bf16 需要 PyTorch &gt;= 1.10 和 Nvidia Ampere GPU。</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"><code>--local_rank</code></td>
<td align="left"><code>-1</code></td>
<td align="left">对于分布式训练：local_rank</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"><code>--save_model_every_n_steps</code></td>
<td align="left"><code>None</code></td>
<td align="left"><code>None</code></td>
</tr>
<tr>
<td align="left"></td>
<td align="left"><code>--auto_test_model</code></td>
<td align="left"></td>
<td align="left">保存后是否自动测试模型</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"><code>--test_prompt</code></td>
<td align="left"><code>A photo of a cat</code></td>
<td align="left">用于测试模型的提示。</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"><code>--test_prompts_file</code></td>
<td align="left"><code>None</code></td>
<td align="left">包含用于测试模型的提示的文件。示例：test_prompts.txt，每一行都是一个提示</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"><code>--test_negative_prompt</code></td>
<td align="left">``</td>
<td align="left">用于测试模型的否定提示。</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"><code>--test_seed</code></td>
<td align="left"><code>42</code></td>
<td align="left">用于测试模型的种子。</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"><code>--test_num_per_prompt</code></td>
<td align="left"><code>1</code></td>
<td align="left">每个提示生成的图像数量。</td>
</tr>
</tbody>
</table>
<ul>
<li>细节</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">instance_data_dir</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"You must specify a train data directory."</span><span class="p">)</span>
<span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">with_prior_preservation</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">class_data_dir</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"You must specify a data directory for class images."</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">class_prompt</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"You must specify prompt for class images."</span><span class="p">)</span>
</code></pre></div>
<!--
[飞桨 dreambooth 训练教程](https://docs.qq.com/doc/DUHVuZ3BNV0FkT1R6)
-->
<div class="footnote">
<hr/>
<ol>
<li id="fn:1">
<p><a href="https://www.reddit.com/r/StableDiffusion/comments/yhw7k8/testing_dreambooth_for_consistency_with_complex/">testing_dreambooth_for_consistency_with_complex</a> <a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
<li id="fn:2">
<p><a href="https://www.reddit.com/r/StableDiffusion/comments/ybxv7h/good_dreambooth_formula/">good_dreambooth_formula</a> <a class="footnote-backref" href="#fnref:2" title="Jump back to footnote 2 in the text">↩</a></p>
</li>
<li id="fn:3">
<p><a href="https://github.com/nitrosocke/dreambooth-training-guide">dreambooth-training-guide</a> <a class="footnote-backref" href="#fnref:3" title="Jump back to footnote 3 in the text">↩</a><a class="footnote-backref" href="#fnref2:3" title="Jump back to footnote 3 in the text">↩</a></p>
</li>
<li id="fn:4">
<p><a href="https://gist.github.com/crosstyan/f912612f4c26e298feec4a2924c41d99">crosstyan-s-guide</a> <a class="footnote-backref" href="#fnref:4" title="Jump back to footnote 4 in the text">↩</a></p>
</li>
<li id="fn:5">
<p><a href="https://github.com/XavierXiao/Dreambooth-Stable-Diffusion">XavierXiao/Dreambooth-Stable-Diffusion</a> <a class="footnote-backref" href="#fnref:5" title="Jump back to footnote 5 in the text">↩</a></p>
</li>
<li id="fn:6">
<p><a href="https://zhuanlan.zhihu.com/p/584736850">StableDiffusion/DreamBooth 自训练全教程</a> <a class="footnote-backref" href="#fnref:6" title="Jump back to footnote 6 in the text">↩</a></p>
</li>
</ol>
</div>
<hr/>
<div class="md-source-file">
<small>
    
      最后更新:
      <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-datetime">2022年11月23日 06:55:55</span>
<br/>
        创建日期:
        <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-datetime">2022年11月2日 03:59:46</span>
</small>
</div>
</article>
</div>
</div>
<a class="md-top md-icon" data-md-component="top" hidden="" href="#">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"></path></svg>
            回到页面顶部
          </a>
</main>
<footer class="md-footer">
<nav aria-label="页脚" class="md-footer__inner md-grid">
<a aria-label="上一页: Hypernetwork 训练" class="md-footer__link md-footer__link--prev" href="../Hypernetwork/" rel="prev">
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
</div>
<div class="md-footer__title">
<div class="md-ellipsis">
<span class="md-footer__direction">
                上一页
              </span>
              Hypernetwork 训练
            </div>
</div>
</a>
<a aria-label="下一页: AestheticGradients 训练" class="md-footer__link md-footer__link--next" href="../AestheticGradients/" rel="next">
<div class="md-footer__title">
<div class="md-ellipsis">
<span class="md-footer__direction">
                下一页
              </span>
              AestheticGradients 训练
            </div>
</div>
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"></path></svg>
</div>
</a>
</nav>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
<div class="md-copyright__highlight">
      Copyright © 采用 GFDL 协议

    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
<div class="md-social">
<a class="md-social__link" href="https://t.me/s/StableDiffusion_CN_WIKI" rel="noopener" target="_blank" title="t.me">
<svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M248 8C111.033 8 0 119.033 0 256s111.033 248 248 248 248-111.033 248-248S384.967 8 248 8Zm114.952 168.66c-3.732 39.215-19.881 134.378-28.1 178.3-3.476 18.584-10.322 24.816-16.948 25.425-14.4 1.326-25.338-9.517-39.287-18.661-21.827-14.308-34.158-23.215-55.346-37.177-24.485-16.135-8.612-25 5.342-39.5 3.652-3.793 67.107-61.51 68.335-66.746.153-.655.3-3.1-1.154-4.384s-3.59-.849-5.135-.5q-3.283.746-104.608 69.142-14.845 10.194-26.894 9.934c-8.855-.191-25.888-5.006-38.551-9.123-15.531-5.048-27.875-7.717-26.8-16.291q.84-6.7 18.45-13.7 108.446-47.248 144.628-62.3c68.872-28.647 83.183-33.623 92.511-33.789 2.052-.034 6.639.474 9.61 2.885a10.452 10.452 0 0 1 3.53 6.716 43.765 43.765 0 0 1 .417 9.769Z"></path></svg>
</a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "toc.follow", "navigation.top", "navigation.tracking", "navigation.indexes", "navigation.expand", "navigation.sections"], "search": "../../../assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.config.lang": "ja", "search.config.pipeline": "trimmer, stemmer", "search.config.separator": "[\\s\\-\uff0c\u3002]+", "search.placeholder": "\u641c\u7d22", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version.title": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script>
<script src="../../../assets/javascripts/bundle.d6c3db9e.min.js"></script>
<script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});})</script></body>
</html>